function BodenCarousel(e){function o(){$(".quicklink").each(function(){$(this).fancybox({type:"iframe",width:420,height:190,padding:25,onComplete:function(){$("#fancybox-frame").load(function(){$("#fancybox-content").height($(this).contents().find("body").height()+15);$.fancybox.center(true)})},afterLoad:function(){p.after_load()},beforeClose:function(){p.before_close()}})})}function u(e){var t=s.slice(0,2);var n=t==="en"?0:t==="de"?1:t==="fr"?2:0;return e[n]}function a(e){n.feature_wrapper.append(e)}var t=e||{};var n=$.extend({cm_tag:"SS15-TEMPLATE",img_path:"/images/magazine/features/SS15-carousel/",quickshop_path:"/products/outfitting.aspx?qr=",animation_speed:400,body:$("body"),feature_wrapper:$(".feature-wrapper"),product_codes:[null,"WH793LAV|WU003PPK|AR660NUD|AV090YEL","WK959SPK|WH779BLU|AR654PPK","WG590RED|AR662BLK","WC114OAT|WV020GRY|WE479OYS|AR662BLK","WE465NAV|WH787PPK|AR654BLK|AM224YEL"]},t.global_settings);var r=[];var s=$("html").attr("lang");var f=function(){var t=$.extend({enabled:false,layer_class:"layer",duration:1,delay:.4},e.layers_settings);var n={enabled:t.enabled,slide:function(){return false}};if(!t.enabled)return n;n.slide=function(e,n,r,i){var s=e.find("."+t.layer_class);var o=r-i?true:false;var u=n;var a=o?{left:u,right:"auto"}:{right:u,left:"auto"};TweenMax.staggerFrom(s,t.duration,a,t.delay)};return n}();var l=function(){var t=$.extend({enabled:false,container:".bg-container",slide_prefix:".slide",img_path:n.img_path,speed:300,repeat:-1,paused:true,yoyo:true,repeat_delay:0,scene:[2,null,null,null,null,null]},e.jpganimate_settings);var r={enabled:t.enabled,playFrames:function(){return false},initialise:function(){return false}};if(!t.enabled)return r;var s=Modernizr.backgroundsize;var o=null;var u=function(e,n,r){var e=$(e);var s=e.find(t.container);var o="";var u=true;for(i=1;i<=n;i++){var a=i===1?" first":"";var f=t.css3?'<div class="animation-frame'+a+'" style="background-image: url('+t.img_path+"slide"+r+"/slide"+i+'.jpg);"></div>':'<div class="animation-frame'+a+'"><img class="ie-bg" src="'+t.img_path+"slide"+r+"/slide"+i+'.jpg" /></div>';o+=f}s.append(o)};var a=function(e,n){var r=$(e).find(t.container).children();var i=t.speed/1e3;var s=(new TimelineMax({repeat:t.repeat,paused:t.paused,yoyo:t.yoyo,repeat_delay:t.repeat_delay/1e3})).staggerFromTo(r,i,{zIndex:0},{zIndex:1},t.speed/1e3);return s};r.playFrames=function(e,t){if(o===null)return false;var n=o[e];var r=o[t];if(n!=undefined)n.play();if(r!=undefined)r.pause()};r.initialise=function(){var e=Array();$.each(t.scene,function(n,r){var i=t.slide_prefix+n;if(r!=null){u(i,r,n);e[n]=a(".slide"+n,t.scene[n])}});o=e};return r}();var c=function(){var e=$.extend({enabled:true,img_path:n.img_path,name_format:{prefix:"slide",suffix:"-thumbnail.jpg"},animation_speed:n.animation_speed},t.pager_settings);var r={enabled:e.enabled,container:false,toggle_pager:function(){return false},generate_thumbnail:function(){return false},close_pager:function(){return false},initialise:function(){return false}};if(!e.enabled)return r;var i,s;var o="open";r.generate_thumbnail=function(t){var n;var r=e.img_path+e.name_format.prefix+t+e.name_format.suffix;var n='<div class="thumb-inner"><div class="thumb-img" style="background-image: url('+r+')"></div></div>';return n};var u=function(){return i.hasClass(o)};r.toggle_pager=function(e){var t=e||false;if(t&&u){i.removeClass(o);return false}var n=function(){i.toggleClass(o)};n()};var f=function(){s.click(function(){r.toggle_pager()})};r.initialise=function(){var e=['<div id="pager-wrapper">','<div id="pager-container">',"</div>",'<div id="pager-tab"></div>',"</div>"].join("\n");a(e);r.container=$("#pager-container");i=$("#pager-wrapper");s=$("#pager-tab");f()};return r}();var h=function(){function m(){var e=f.children("li").not(".bx-clone");var n=[];var r=t.market+t.quickshop_path;e.each(function(){var e=$(".quicklink.retrieve",this);if(e.length==0){n.push(null)}else{var r=e.attr("href");var i=r.replace("/"+t.market+t.quickshop_path,"");n.push(i)}});return n}var t=$.extend({enabled:true,slider_class:".bxslider",codes:n.product_codes,quickshop_path:n.quickshop_path,open_class:"open",max_height:210,market:s},e.productgrid_settings);var o={enabled:t.enabled,initialise:function(){return false},update:function(){return false}};if(!t.enabled)return o;var f=$(t.slider_class);var l,c,h,p,d;if(t.codes==="auto")t.codes=m();var v=function(e){var n="";var s=t.codes;var o=function(){return t.codes.toString().replace(/,/g,"|")};var u=t.quickshop_path+o();var a=t.codes;$.get(u,function(t){var s=$(t);var o=s.find(".ProductMain");var u=0;for(i=0;i<a.length;i++){if(a[i]!=null){var f=a[i];var c=a[i].split("|");for(x=0;x<c.length;x++){var h=c[x].slice(0,5);if($("[data-productcode="+h+"]",s).data("productcode")!=null){var p='<li class="mix slide'+i+'"><a class="quicklink" href="/products/outfitting.aspx?qr='+c[x]+'"><img src="'+o.eq(u).attr("src")+'" /></a></li>';u++;n+=p}else{r.push("The product code does not exist: "+c[x])}}}}l.prepend(n);e()})};o.update=function(e,n){var r=t.codes;var n=n||false;var i=t.codes[e]!=null?true:false;var s=i?".slide"+e:"none";if(!l.mixItUp("isLoaded"))l.mixItUp({load:{filter:"none"}});l.mixItUp("filter",s);var o=$("body").hasClass("fullscreen");if(i){p.attr("href",t.quickshop_path+t.codes[e]);if(!$("#grid-ui").is(":visible")){if(n){$("#grid-ui").fadeIn()}else{$("#grid-ui").show()}}}else{p.attr("href","#");if(h.is(":visible")){h.fadeOut()}else{if(n){h.fadeOut()}else{h.hide()}}}};var g=function(){var e=l.hasClass(l.open_class);if(!Modernizr.csstransitions){var n=e?0:t.max_height;l.animate({max_height:n},t.animation_speed,function(){if(e){d.text(text)}else{l.removeAttr("style")}})}c.toggleClass("open")};var y=function(){d.click(function(){g()})};o.initialise=function(e){var t=u(["Buy complete look","Den kompletten Look shoppen","Acheter la tenue compl√®te"]);var n=u(["Show","Anzeigen","Montrer"]);var r=u(["Hide","Verbergen","Cacher"]);var i=['<div id="grid-container">','<div id="grid-ui" style="display: none">','<a href="#" class="quicklink" id="complete-look">'+t+"</a>",'<a href="#" id="toggle-grid">','<span class="show-hide" id="show-copy">'+n+"</span>",'<span class="show-hide" id="hide-copy">'+r+"</span>","</a>","</div>",'<ul id="grid">',"<!-- Products are dynamically created here -->","</ul>","</div>"].join("\n");a(i);l=$("#grid");c=$("#grid-container");h=$("#grid-ui");p=$("#complete-look");d=$("#toggle-grid");o.update(0);v(e);y()};o.ui=t.ui;return o}();var p=function(){var e=$.extend({enabled:true,market:s},t.shoppingbag_settings);var n={after_load:function(){return false},before_close:function(){return false},update:function(){return false},initialise:function(){return false}};if(!e.enabled)return n;n.after_load=function(){var e=$(".fancybox-iframe").contents().find("#addToBagBtn");e.click(function(){if($(this).hasClass("enabled")){$("#shopping-bag").removeClass("changed").addClass("changed");p.update()}})};n.update=function(){var e=$("#ShoppingBag1_lblCount");var t=e.text();var n=25;var r=setInterval(function(){var i=e.text();if(i!=t){e.text(i);clearInterval(r)}if(n===0)clearInterval(r);n--},200)};n.before_close=function(){$("#shopping-bag").removeClass("changed")};n.initialise=function(){var e=u(["Bag","Warenkorb","Panier"]);var t=['<a title="Bag" href="~/checkout/shopping-bag.html#nav" id="shopping-bag">','<h2 id="bag-copy">'+e+"</h2>",'<span class="bagCounter" id="sb-qty">0</span><span class="sbItemText">items</span>','<span class="sbTotalPriceText">Total</span>','<span id="sb-value">&pound;0.00</span>',"</a>"].join("\n");$(".fullscreen-info").prepend(t)};return n}();var d=$.extend({initial_slide:0,active_class:"active-slide",normal_width:1e3,fullscreen_enabled:true,fullscreen_button:$(".fullscreen-btn"),body:n.body,resize_delay:100,nav_location:{normal:"#ghost-",fullscreen:"#fullscreen_nav-"},ui_switch:false},t.slider_settings);var v,m;var g={is_active:function(){return false},mode:function(){return S(d.normal_width,d.initial_slide,d.nav_location.normal)},apply_ui:function(){return false}};var y=function(){return g.is_active()?$(window).width():d.normal_width};if(d.fullscreen_enabled){var b=[];b[0]=['<div id="fullscreen_nav-container">','<div id="fullscreen_nav-left" class="fullscreen-nav"></div>','<div id="fullscreen_nav-right" class="fullscreen-nav"></div>','<div class="fullscreen-info">','<a class="fullscreen-btn" href="#">Small screen</a>',"</div>","</div>	"].join("\n");b[1]=['<div class="fullscreen-btn">','<a href="#">Full screen</a>',"</div>"].join("\n");g={is_active:function(){return d.body.hasClass("fullscreen")},mode:function(){return this.is_active()?S($(window).width(),d.initial_slide,d.nav_location.fullscreen):S(d.normal_width,d.initial_slide,d.nav_location.normal)},apply_ui:function(){a(b[0]);$("#ghost-right").append(b[1]);this.bind_ui()},bind_ui:function(){$(".fullscreen-btn").click(function(){g.toggle()})},toggle:function(){d.body.toggleClass("fullscreen");v.reloadSlider(g.mode());if(!g.is_active())E();h.update(d.initial_slide,false)}}}if(d.ui_switch.constructor===Array){}var w=function(e,t){if(!d.ui_switch)return false;var r="ui-switch";var i=t.constructor===Array?t:[t];var s=$(".feature-wrapper");$.each(i,function(t,r){if(r==e){n.feature_wrapper.addClass("ui-switch");return false}if(n.feature_wrapper.hasClass("ui-switch")){n.feature_wrapper.removeClass("ui-switch");return false}})};var E=function(){var e=$(".bx-viewport").offset().left+$(".bx-viewport").width();$(".ghost").each(function(){var t=$(this);var n=t.attr("id").replace("ghost-","");var r=n==="left"?{right:e}:{left:e};t.css(r)})};var S=function(e,t,r){return{slideWidth:e,startSlide:t,pager:c.enabled,pagerSelector:c.container,buildPager:function(e){return c.generate_thumbnail(e)},onSliderLoad:function(e){cmCreateElementTag(n.cm_tag+"_"+e,"OUTFIT");d.initial_slide=e;E();l.playFrames(e)},onSlideBefore:function(e,t,n){c.toggle_pager(true);d.initial_slide=n;f.slide(e,y(),t,n);h.update(n,true);w(n)},onSlideAfter:function(e,t,r){l.playFrames(r,t);cmCreateElementTag(n.cm_tag+"_"+r,"OUTFIT")},prevSelector:r+"left",nextSelector:r+"right"}};var T=function(){E();if(g.is_active()){clearTimeout(m);m=setTimeout(function(){var e=$("."+d.active_class).index()-1;v.reloadSlider(g.mode())},d.resize_delay);return false}};var N=function(){if(n.cm_tag==="SS15-TEMPLATE")r.push("You have not changed the coremetrics tag");for(i in r){console.log("WARNING: "+r[i])}};var C=function(){$("[name=viewport]","#Head1").attr("content","width=1000");c.initialise();l.initialise();h.initialise(function(){o();N();p.initialise()});v=$(".bxslider").bxSlider(g.mode());g.apply_ui();o()};var k=function(){if(d.fullscreen_enabled)d.fullscreen_button.click(function(){toggle_fullscreen()});$(window).resize(function(){T()})}();return{init:C}}window.Modernizr=function(e,t,n){function r(e){v.cssText=e}function i(e,t){return r(prefixes.join(e+";")+(t||""))}function s(e,t){return typeof e===t}function o(e,t){return!!~(""+e).indexOf(t)}function u(e,t){for(var r in e){var i=e[r];if(!o(i,"-")&&v[i]!==n)return t=="pfx"?i:!0}return!1}function a(e,t,r){for(var i in e){var o=t[e[i]];if(o!==n)return r===!1?e[i]:s(o,"function")?o.bind(r||t):o}return!1}function f(e,t,n){var r=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+b.join(r+" ")+r).split(" ");return s(t,"string")||s(t,"undefined")?u(i,t):(i=(e+" "+w.join(r+" ")+r).split(" "),a(i,t,n))}var l="2.8.3",c={},h=t.documentElement,p="modernizr",d=t.createElement(p),v=d.style,m,g={}.toString,y="Webkit Moz O ms",b=y.split(" "),w=y.toLowerCase().split(" "),E={},S={},x={},T=[],N=T.slice,C,k={}.hasOwnProperty,L;!s(k,"undefined")&&!s(k.call,"undefined")?L=function(e,t){return k.call(e,t)}:L=function(e,t){return t in e&&s(e.constructor.prototype[t],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if(typeof t!="function")throw new TypeError;var n=N.call(arguments,1),r=function(){if(this instanceof r){var i=function(){};i.prototype=t.prototype;var s=new i,o=t.apply(s,n.concat(N.call(arguments)));return Object(o)===o?o:s}return t.apply(e,n.concat(N.call(arguments)))};return r}),E.backgroundsize=function(){return f("backgroundSize")},E.csstransforms=function(){return!!f("transform")},E.csstransitions=function(){return f("transition")};for(var A in E)L(E,A)&&(C=A.toLowerCase(),c[C]=E[A](),T.push((c[C]?"":"no-")+C));return c.addTest=function(e,t){if(typeof e=="object")for(var r in e)L(e,r)&&c.addTest(r,e[r]);else{e=e.toLowerCase();if(c[e]!==n)return c;t=typeof t=="function"?t():t,typeof enableClasses!="undefined"&&enableClasses&&(h.className+=" "+(t?"":"no-")+e),c[e]=t}return c},r(""),d=m=null,c._version=l,c._domPrefixes=w,c._cssomPrefixes=b,c.testProp=function(e){return u([e])},c.testAllProps=f,c}(this,this.document)
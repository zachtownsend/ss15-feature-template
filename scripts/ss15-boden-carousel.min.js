function BodenCarousel(e){function n(){$(".quicklink").each(function(){$(this).fancybox({type:"iframe",width:420,height:190,padding:25,onComplete:function(){$("#fancybox-frame").load(function(){$("#fancybox-content").height($(this).contents().find("body").height()+15),$.fancybox.center(!0)})},afterLoad:function(){h.after_load()},beforeClose:function(){h.before_close()}})})}function t(e){var n=u.slice(0,2),i="en"===n?0:"de"===n?1:"fr"===n?2:0;return e[i]}function a(e){c.feature_wrapper.append(e)}function r(e,n,i){var t=e instanceof jQuery?e:$(e);t.on(n,i)}var o,l,s=e||{},c=$.extend({cm_tag:"SS15-TEMPLATE",img_path:"/images/magazine/features/SS15-carousel/",quickshop_path:"/products/outfitting.aspx?qr=",animation_speed:400,body:$("body"),feature_wrapper:$(".feature-wrapper"),product_codes:[null,"WH793LAV|WU003PPK|AR660NUD|AV090YEL","WK959SPK|WH779BLU|AR654PPK","WG590RED|AR662BLK","WC114OAT|WV020GRY|WE479OYS|AR662BLK","WE465NAV|WH787PPK|AR654BLK|AM224YEL"]},s.global_settings),u=$("html").attr("lang"),d=function(){var e=$.extend({enabled:!1,layer_class:"layer",duration:1e3,delay:200},s.layers_settings),n={enabled:e.enabled,slide:function(){return!1}};if(!e.enabled)return n;var i=function(e,n,i,t){var a=0,r=function(e,n){var i={};for(key in n)i[key]=e.css(key),"auto"===i[key]&&(i[key]=0);return i};e.each(function(){var e=$(this),o=r(e,i),l=i;e.css(l).delay(a).animate(o,n,"easeInOutQuad"),a+=t})};return n.slide=function(n,t,a,r){var o=n.find("."+e.layer_class),l=t,s={left:l};i(o,e.duration,s,e.delay)},n}(),f=function(){function e(e){var i,t=$(e).find(n.container).children(),a=t.length+n.repeat_delay,r=0,o=!0,l=function(){clearInterval(i),i=setInterval(function(){o?r++:r--;var e=o?1:0;t.eq(r).css({"z-index":e}),n.yoyo?(r===a&&(o=!1),0===r&&(o=!0)):r===a&&(t.css({"z-index":0}),r=0)},n.speed)},s=function(){clearInterval(i)};return{play:l,pause:s}}var n=$.extend({enabled:!1,container:".bg-container",slide_prefix:".slide",img_path:c.img_path,speed:300,repeat:-1,paused:!0,yoyo:!1,repeat_delay:1,scene:[3,3,3,null,3,null]},s.jpganimate_settings),t={enabled:n.enabled,playFrames:function(){return!1},initialise:function(){return!1}};if(!n.enabled)return t;var a=Modernizr.backgroundsize,r=null,o=function(e,t,r){var e=$(e),o=e.find(n.container),l="";for(i=1;i<=t;i++){var s=1===i?" first":"",c=a?'<div class="animation-frame'+s+'" style="background-image: url('+n.img_path+"slide"+r+"/slide"+i+'.jpg);"></div>':'<div class="animation-frame'+s+'"><img class="ie-bg" src="'+n.img_path+"slide"+r+"/slide"+i+'.jpg" /></div>';l+=c}o.append(l)};return t.playFrames=function(e,n){if(null===r)return!1;var i=r[e],t=r[n];void 0!=i&&i.play(),void 0!=t&&t.pause()},t.initialise=function(){var i=Array();$.each(n.scene,function(t,a){var r=n.slide_prefix+t;null!=a&&(o(r,a,t),i[t]=e(".slide"+t,n.scene[t]))}),r=i},t}(),p=function(){var e=$.extend({enabled:!0,img_path:c.img_path,name_format:{prefix:"slide",suffix:"-thumbnail.jpg"},animation_speed:c.animation_speed},s.pager_settings),n={enabled:e.enabled,container:!1,toggle_pager:function(){return!1},generate_thumbnail:function(){return!1},close_pager:function(){return!1},initialise:function(){return!1}};if(!e.enabled)return n;var i,t,o="open";n.generate_thumbnail=function(n){var i,t=e.img_path+e.name_format.prefix+n+e.name_format.suffix,i='<div class="thumb-inner"><div class="thumb-img" style="background-image: url('+t+')"></div></div>';return i};var l=function(){return i.hasClass(o)};return n.toggle_pager=function(e){var n=e||!1;if(n&&l)return i.removeClass(o),!1;var t=function(){i.toggleClass(o)};t()},n.initialise=function(){var e=['<div id="pager-wrapper">','<div id="pager-container">',"</div>",'<div id="pager-tab"></div>',"</div>"].join("\n");a(e),n.container=$("#pager-container"),i=$("#pager-wrapper"),t=$("#pager-tab"),r(t,"click",function(){n.toggle_pager()})},n}(),g=function(){function e(){{var e=h.children("li").not(".bx-clone"),i=[];n.market+n.quickshop_path}return e.each(function(){var e=$(".quicklink.retrieve",this);if(0==e.length)i.push(null);else{var t=e.attr("href"),a=t.replace("/"+n.market+n.quickshop_path,"");i.push(a)}}),i}var n=$.extend({enabled:!0,slider_class:".bxslider",codes:c.product_codes,quickshop_path:c.quickshop_path,open_class:"open",max_height:210,market:u},s.productgrid_settings),o={enabled:n.enabled,initialise:function(){return!1},update:function(){return!1}};if(!n.enabled)return o;var l,d,f,p,g,h=$(n.slider_class);"auto"===n.codes&&(n.codes=e());var v=function(e){var t="",a=(n.codes,function(){return n.codes.toString().replace(/,/g,"|")}),r=n.quickshop_path+a(),o=n.codes;$.get(r,function(n){var a=$(n),r=a.find(".ProductMain"),s=0;for(i=0;i<o.length;i++)if(null!=o[i]){var c=(o[i],o[i].split("|"));for(x=0;x<c.length;x++){var u=c[x].slice(0,5);if(null!=$("[data-productcode="+u+"]",a).data("productcode")){var d='<li class="mix slide'+i+'"><a class="quicklink" href="/products/outfitting.aspx?qr='+c[x]+'"><img src="'+r.eq(s).attr("src")+'" /></a></li>';s++,t+=d}else console.error("The product code does not exist: "+c[x])}}l.prepend(t),$("#grid-loading").fadeOut(function(){var e=$(".active-slide").index()-1;l.mixItUp("filter",".slide"+e)}),e()})};o.update=function(e,i){var i=(n.codes,i||!1),t=null!=n.codes[e]?!0:!1,a=t?".slide"+e:"none";l.mixItUp("isLoaded")||l.mixItUp({load:{filter:"none"}}),l.mixItUp("filter",a);$("body").hasClass("fullscreen");t?(p.attr("href",n.quickshop_path+n.codes[e]),$("#grid-ui").is(":visible")||(i?$("#grid-ui").fadeIn():$("#grid-ui").show())):(p.attr("href","#"),f.is(":visible")?f.fadeOut():i?f.fadeOut():f.hide())};var _=function(){var e=l.hasClass(l.open_class);if(!Modernizr.csstransitions){var i=e?0:n.max_height;l.animate({max_height:i},n.animation_speed,function(){e?g.text(text):l.removeAttr("style")})}d.toggleClass("open")};return o.initialise=function(e){var n=t(["Buy complete look","Den kompletten Look shoppen","Acheter la tenue compl√®te"]),i=t(["Show","Anzeigen","Montrer"]),s=t(["Hide","Verbergen","Cacher"]),u=['<div id="grid-container">','<div id="grid-ui" style="display: none">','<a href="#" class="quicklink" id="complete-look">'+n+"</a>",'<a href="#" id="toggle-grid">','<span class="show-hide" id="show-copy">'+i+"</span>",'<span class="show-hide" id="hide-copy">'+s+"</span>","</a>",'<br /><img id="grid-loading" src="'+c.img_path+'bx_loader.gif" />',"</div>",'<ul id="grid">',"<!-- Products are dynamically created here -->","</ul>","</div>"].join("\n");a(u),l=$("#grid"),d=$("#grid-container"),f=$("#grid-ui"),p=$("#complete-look"),g=$("#toggle-grid"),o.update(0),v(e),r(g,"click",function(){_()})},o.ui=n.ui,o}(),h=function(){var e=$.extend({enabled:!0,market:u},s.shoppingbag_settings),n={after_load:function(){return!1},before_close:function(){return!1},update:function(){return!1},initialise:function(){return!1}};if(!e.enabled)return n;var i,a;n.after_load=function(){var e=$(".fancybox-iframe").contents().find("#addToBagBtn");e.click(function(){$(this).hasClass("enabled")&&($("#shopping-bag").removeClass("changed").addClass("changed"),h.update())})};var r=function(e){var e=$(e).text();return e},o=function(){var e=r("#ShoppingBag1_lblCount"),n=r("#ShoppingBag1_lblTotal");i.text(e),a.text(n)};return n.update=function(){var e=$("#sb-qty").text(),n=25,i=setInterval(function(){var t=$("#ShoppingBag1_lblCount").text();t!=e&&(o(),clearInterval(i)),0===n&&clearInterval(i),n--},200)},n.before_close=function(){$("#shopping-bag").removeClass("changed")},n.initialise=function(){var e=t(["Bag","Warenkorb","Panier"]),r=$("#ShoppingBag1_lblTotal").text(),o=['<a title="Bag" href="~/checkout/shopping-bag.html#nav" id="shopping-bag">','<h2 id="bag-copy">'+e+"</h2>",'<span class="bagCounter" id="sb-qty"></span><span class="sbItemText">items</span>','<span class="sbTotalPriceText">Total</span>','<span id="sb-value">'+r+"</span>","</a>"].join("\n");$(".fullscreen-info").prepend(o),i=$("#sb-qty"),a=$("#sb-value"),n.update()},n}(),v=function(){function e(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),i=n.exec(location.search);return null===i?"":decodeURIComponent(i[1].replace(/\+/g," "))}var n=e("slide");return n=""!=n?n:0}(),_=$.extend({initial_slide:v,active_class:"active-slide",normal_width:1e3,fullscreen_enabled:!0,fullscreen_button:$(".fullscreen-btn"),body:c.body,resize_delay:100,border:10,nav_location:{normal:"#ghost-",fullscreen:"#fullscreen_nav-"},ui_switch:!1},s.slider_settings),m={is_active:function(){return!1},mode:function(){return C(_.normal_width,_.initial_slide,_.nav_location.normal)},apply_ui:function(){return!1}},b=function(){return m.is_active()?$(window).width():_.normal_width};if(_.fullscreen_enabled){var y=[];y[0]=['<div id="fullscreen_nav-container">','<div id="fullscreen_nav-left" class="fullscreen-nav"></div>','<div id="fullscreen_nav-right" class="fullscreen-nav"></div>','<div class="fullscreen-info">','<a class="fullscreen-btn" href="#">Small screen</a>',"</div>","</div>	"].join("\n"),y[1]=['<div class="fullscreen-btn">','<a href="#">Full screen</a>',"</div>"].join("\n"),m={is_active:function(){return _.body.hasClass("fullscreen")},mode:function(){return this.is_active()?C($(window).width(),_.initial_slide,_.nav_location.fullscreen):C(_.normal_width,_.initial_slide,_.nav_location.normal)},apply_ui:function(){a(y[0]),$("#ghost-right").append(y[1]),r(".fullscreen-btn","click",function(){m.toggle()})},toggle:function(){_.body.toggleClass("fullscreen"),o.reloadSlider(m.mode()),m.is_active()||k(),g.update(_.initial_slide,!1)}}}var w=function(e,n){if(!_.ui_switch)return!1;{var i=n.constructor===Array?n:[n];$(".feature-wrapper")}$.each(i,function(n,i){return i==e?(c.feature_wrapper.addClass("ui-switch"),!1):c.feature_wrapper.hasClass("ui-switch")?(c.feature_wrapper.removeClass("ui-switch"),!1):void 0})},k=function(){var e=$(".bx-viewport").offset().left+$(".bx-viewport").width();$(".ghost").each(function(){var n=$(this),i=n.attr("id").replace("ghost-",""),t="left"===i?{right:e}:{left:e};n.css(t)})},C=function(e,n,i){return{slideWidth:e,startSlide:n,pager:p.enabled,pagerSelector:p.container,oneToOneTouch:!1,buildPager:function(e){return p.generate_thumbnail(e)},onSliderLoad:function(e){cmCreateElementTag(c.cm_tag+"_"+e,"OUTFIT"),_.initial_slide=e,k(),f.playFrames(e),g.update(e)},onSlideBefore:function(e,n,i){$("."+_.active_class).removeClass(_.active_class),e.addClass(_.active_class),p.toggle_pager(!0),_.initial_slide=i,d.slide(e,b(),n,i),g.update(i,!0),w(i)},onSlideAfter:function(e,n,i){f.playFrames(i,n),cmCreateElementTag(c.cm_tag+"_"+i,"OUTFIT")},prevSelector:i+"left",nextSelector:i+"right"}},S=function(){return k(),m.is_active()?(clearTimeout(l),l=setTimeout(function(){$("."+_.active_class).index()-1;o.reloadSlider(m.mode())},_.resize_delay),!1):void 0},T=function(){return r(window,"resize",function(){S()}),r(".next","click",function(e){e.preventDefault(),o.goToNextSlide()}),_.fullscreen_enabled?void r(_.fullscreen_button,"click",function(){toggle_fullscreen()}):!1},A=function(){try{if("SS15-TEMPLATE"===c.cm_tag)throw"You have not changed the coremetrics tag";if("/images/magazine/features/SS15-carousel/"===c.img_path)throw"You haven't changed the default image path"}catch(e){console.error(e)}},P=function(){$("[name=viewport]","#Head1").attr("content","width=1000"),p.initialise(),f.initialise(),g.initialise(function(){n(),A()}),o=$(".bxslider").bxSlider(m.mode()),m.apply_ui(),n(),T(),h.initialise()};return{init:P}}window.Modernizr=function(e,n,i){function t(e){_.cssText=e}function a(e,n){return typeof e===n}function r(e,n){return!!~(""+e).indexOf(n)}function o(e,n){for(var t in e){var a=e[t];if(!r(a,"-")&&_[a]!==i)return"pfx"==n?a:!0}return!1}function l(e,n,t){for(var r in e){var o=n[e[r]];if(o!==i)return t===!1?e[r]:a(o,"function")?o.bind(t||n):o}return!1}function s(e,n,i){var t=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+b.join(t+" ")+t).split(" ");return a(n,"string")||a(n,"undefined")?o(r,n):(r=(e+" "+y.join(t+" ")+t).split(" "),l(r,n,i))}var c,u,d,f="2.8.3",p={},g=n.documentElement,h="modernizr",v=n.createElement(h),_=v.style,m=({}.toString,"Webkit Moz O ms"),b=m.split(" "),y=m.toLowerCase().split(" "),x={},$=[],w=$.slice,k={}.hasOwnProperty;d=a(k,"undefined")||a(k.call,"undefined")?function(e,n){return n in e&&a(e.constructor.prototype[n],"undefined")}:function(e,n){return k.call(e,n)},Function.prototype.bind||(Function.prototype.bind=function(e){var n=this;if("function"!=typeof n)throw new TypeError;var i=w.call(arguments,1),t=function(){if(this instanceof t){var a=function(){};a.prototype=n.prototype;var r=new a,o=n.apply(r,i.concat(w.call(arguments)));return Object(o)===o?o:r}return n.apply(e,i.concat(w.call(arguments)))};return t}),x.backgroundsize=function(){return s("backgroundSize")},x.csstransforms=function(){return!!s("transform")},x.csstransitions=function(){return s("transition")};for(var C in x)d(x,C)&&(u=C.toLowerCase(),p[u]=x[C](),$.push((p[u]?"":"no-")+u));return p.addTest=function(e,n){if("object"==typeof e)for(var t in e)d(e,t)&&p.addTest(t,e[t]);else{if(e=e.toLowerCase(),p[e]!==i)return p;n="function"==typeof n?n():n,"undefined"!=typeof enableClasses&&enableClasses&&(g.className+=" "+(n?"":"no-")+e),p[e]=n}return p},t(""),v=c=null,p._version=f,p._domPrefixes=y,p._cssomPrefixes=b,p.testProp=function(e){return o([e])},p.testAllProps=s,p}(this,this.document);
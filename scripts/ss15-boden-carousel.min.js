function BodenCarousel(e){function n(){$(".quicklink").each(function(){$(this).fancybox({type:"iframe",width:420,height:190,padding:25,onComplete:function(){$("#fancybox-frame").load(function(){$("#fancybox-content").height($(this).contents().find("body").height()+15),$.fancybox.center(!0)})},afterLoad:function(){v.after_load()},beforeClose:function(){v.before_close()}})})}function t(e){var n=d.slice(0,2),t="en"===n?0:"de"===n?1:"fr"===n?2:0;return e[t]}function a(e){c.feature_wrapper.append(e)}function r(e,n,t){var i=e instanceof jQuery?e:$(e);i.on(n,t)}var o,l,s=e||{},c=$.extend({cm_tag:"SS15-TEMPLATE",img_path:"/images/magazine/features/SS15-carousel/",quickshop_path:"/products/outfitting.aspx?qr=",animation_speed:400,body:$("body"),feature_wrapper:$(".feature-wrapper"),product_codes:[null,"WH793LAV|WU003PPK|AR660NUD|AV090YEL","WK959SPK|WH779BLU|AR654PPK","WG590RED|AR662BLK","WC114OAT|WV020GRY|WE479OYS|AR662BLK","WE465NAV|WH787PPK|AR654BLK|AM224YEL"]},s.global_settings),u=[],d=$("html").attr("lang"),f=function(){var e=$.extend({enabled:!1,layer_class:"layer",duration:1e3,delay:200},s.layers_settings),n={enabled:e.enabled,slide:function(){return!1}};if(!e.enabled)return n;var t=function(e,n,t,i){var a=0,r=function(e,n){var t={};for(key in n)t[key]=e.css(key),"auto"===t[key]&&(t[key]=0);return t};e.each(function(){var e=$(this),o=r(e,t),l=t;e.css(l).delay(a).animate(o,n,"easeInOutQuad"),a+=i})};return n.slide=function(n,i,a,r){var o=n.find("."+e.layer_class),l=i,s={left:l};t(o,e.duration,s,e.delay)},n}(),p=function(){function e(e){var t,i=$(e).find(n.container).children(),a=i.length+n.repeat_delay,r=0,o=!0,l=function(){clearInterval(t),t=setInterval(function(){o?r++:r--;var e=o?1:0;i.eq(r).css({"z-index":e}),n.yoyo?(r===a&&(o=!1),0===r&&(o=!0)):r===a&&(i.css({"z-index":0}),r=0)},n.speed)},s=function(){clearInterval(t)};return{play:l,pause:s}}var n=$.extend({enabled:!1,container:".bg-container",slide_prefix:".slide",img_path:c.img_path,speed:300,repeat:-1,paused:!0,yoyo:!1,repeat_delay:1,scene:[3,3,3,null,3,null]},s.jpganimate_settings),t={enabled:n.enabled,playFrames:function(){return!1},initialise:function(){return!1}};if(!n.enabled)return t;var a=Modernizr.backgroundsize,r=null,o=function(e,t,r){var e=$(e),o=e.find(n.container),l="";for(i=1;i<=t;i++){var s=1===i?" first":"",c=a?'<div class="animation-frame'+s+'" style="background-image: url('+n.img_path+"slide"+r+"/slide"+i+'.jpg);"></div>':'<div class="animation-frame'+s+'"><img class="ie-bg" src="'+n.img_path+"slide"+r+"/slide"+i+'.jpg" /></div>';l+=c}o.append(l)};return t.playFrames=function(e,n){if(null===r)return!1;var t=r[e],i=r[n];void 0!=t&&t.play(),void 0!=i&&i.pause()},t.initialise=function(){var t=Array();$.each(n.scene,function(i,a){var r=n.slide_prefix+i;null!=a&&(o(r,a,i),t[i]=e(".slide"+i,n.scene[i]))}),r=t},t}(),g=function(){var e=$.extend({enabled:!0,img_path:c.img_path,name_format:{prefix:"slide",suffix:"-thumbnail.jpg"},animation_speed:c.animation_speed},s.pager_settings),n={enabled:e.enabled,container:!1,toggle_pager:function(){return!1},generate_thumbnail:function(){return!1},close_pager:function(){return!1},initialise:function(){return!1}};if(!e.enabled)return n;var t,i,o="open";n.generate_thumbnail=function(n){var t,i=e.img_path+e.name_format.prefix+n+e.name_format.suffix,t='<div class="thumb-inner"><div class="thumb-img" style="background-image: url('+i+')"></div></div>';return t};var l=function(){return t.hasClass(o)};return n.toggle_pager=function(e){var n=e||!1;if(n&&l)return t.removeClass(o),!1;var i=function(){t.toggleClass(o)};i()},n.initialise=function(){var e=['<div id="pager-wrapper">','<div id="pager-container">',"</div>",'<div id="pager-tab"></div>',"</div>"].join("\n");a(e),n.container=$("#pager-container"),t=$("#pager-wrapper"),i=$("#pager-tab"),r(i,"click",function(){n.toggle_pager()})},n}(),h=function(){function e(){{var e=v.children("li").not(".bx-clone"),t=[];n.market+n.quickshop_path}return e.each(function(){var e=$(".quicklink.retrieve",this);if(0==e.length)t.push(null);else{var i=e.attr("href"),a=i.replace("/"+n.market+n.quickshop_path,"");t.push(a)}}),t}var n=$.extend({enabled:!0,slider_class:".bxslider",codes:c.product_codes,quickshop_path:c.quickshop_path,open_class:"open",max_height:210,market:d},s.productgrid_settings),o={enabled:n.enabled,initialise:function(){return!1},update:function(){return!1}};if(!n.enabled)return o;var l,f,p,g,h,v=$(n.slider_class);"auto"===n.codes&&(n.codes=e());var _=function(e){var t="",a=(n.codes,function(){return n.codes.toString().replace(/,/g,"|")}),r=n.quickshop_path+a(),o=n.codes;$.get(r,function(n){var a=$(n),r=a.find(".ProductMain"),s=0;for(i=0;i<o.length;i++)if(null!=o[i]){var c=(o[i],o[i].split("|"));for(x=0;x<c.length;x++){var d=c[x].slice(0,5);if(null!=$("[data-productcode="+d+"]",a).data("productcode")){var f='<li class="mix slide'+i+'"><a class="quicklink" href="/products/outfitting.aspx?qr='+c[x]+'"><img src="'+r.eq(s).attr("src")+'" /></a></li>';s++,t+=f}else u.push("The product code does not exist: "+c[x])}}l.prepend(t),e()})};o.update=function(e,t){var t=(n.codes,t||!1),i=null!=n.codes[e]?!0:!1,a=i?".slide"+e:"none";l.mixItUp("isLoaded")||l.mixItUp({load:{filter:"none"}}),l.mixItUp("filter",a);$("body").hasClass("fullscreen");i?(g.attr("href",n.quickshop_path+n.codes[e]),$("#grid-ui").is(":visible")||(t?$("#grid-ui").fadeIn():$("#grid-ui").show())):(g.attr("href","#"),p.is(":visible")?p.fadeOut():t?p.fadeOut():p.hide())};var m=function(){var e=l.hasClass(l.open_class);if(!Modernizr.csstransitions){var t=e?0:n.max_height;l.animate({max_height:t},n.animation_speed,function(){e?h.text(text):l.removeAttr("style")})}f.toggleClass("open")};return o.initialise=function(e){var n=t(["Buy complete look","Den kompletten Look shoppen","Acheter la tenue compl√®te"]),i=t(["Show","Anzeigen","Montrer"]),s=t(["Hide","Verbergen","Cacher"]),c=['<div id="grid-container">','<div id="grid-ui" style="display: none">','<a href="#" class="quicklink" id="complete-look">'+n+"</a>",'<a href="#" id="toggle-grid">','<span class="show-hide" id="show-copy">'+i+"</span>",'<span class="show-hide" id="hide-copy">'+s+"</span>","</a>","</div>",'<ul id="grid">',"<!-- Products are dynamically created here -->","</ul>","</div>"].join("\n");a(c),l=$("#grid"),f=$("#grid-container"),p=$("#grid-ui"),g=$("#complete-look"),h=$("#toggle-grid"),o.update(0),_(e),r(h,"click",function(){m()})},o.ui=n.ui,o}(),v=function(){var e=$.extend({enabled:!0,market:d},s.shoppingbag_settings),n={after_load:function(){return!1},before_close:function(){return!1},update:function(){return!1},initialise:function(){return!1}};if(!e.enabled)return n;var i,a;n.after_load=function(){var e=$(".fancybox-iframe").contents().find("#addToBagBtn");e.click(function(){$(this).hasClass("enabled")&&($("#shopping-bag").removeClass("changed").addClass("changed"),v.update())})};var r=function(e){var e=$(e).text();return e},o=function(){var e=r("#ShoppingBag1_lblCount"),n=r("#ShoppingBag1_lblTotal");i.text(e),a.text(n)};return n.update=function(){var e=$("#sb-qty").text(),n=25,t=setInterval(function(){var i=$("#ShoppingBag1_lblCount").text();i!=e&&(o(),clearInterval(t)),0===n&&clearInterval(t),n--},200)},n.before_close=function(){$("#shopping-bag").removeClass("changed")},n.initialise=function(){var e=t(["Bag","Warenkorb","Panier"]),r=$("#ShoppingBag1_lblTotal").text(),o=['<a title="Bag" href="~/checkout/shopping-bag.html#nav" id="shopping-bag">','<h2 id="bag-copy">'+e+"</h2>",'<span class="bagCounter" id="sb-qty"></span><span class="sbItemText">items</span>','<span class="sbTotalPriceText">Total</span>','<span id="sb-value">'+r+"</span>","</a>"].join("\n");$(".fullscreen-info").prepend(o),i=$("#sb-qty"),a=$("#sb-value"),n.update()},n}(),_=function(){function e(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)"),t=n.exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))}var n=e("slide");return n=""!=n?n:0}(),m=$.extend({initial_slide:_,active_class:"active-slide",normal_width:1e3,fullscreen_enabled:!0,fullscreen_button:$(".fullscreen-btn"),body:c.body,resize_delay:100,border:10,nav_location:{normal:"#ghost-",fullscreen:"#fullscreen_nav-"},ui_switch:!1},s.slider_settings),b={is_active:function(){return!1},mode:function(){return S(m.normal_width,m.initial_slide,m.nav_location.normal)},apply_ui:function(){return!1}},y=function(){return b.is_active()?$(window).width():m.normal_width};if(m.fullscreen_enabled){var w=[];w[0]=['<div id="fullscreen_nav-container">','<div id="fullscreen_nav-left" class="fullscreen-nav"></div>','<div id="fullscreen_nav-right" class="fullscreen-nav"></div>','<div class="fullscreen-info">','<a class="fullscreen-btn" href="#">Small screen</a>',"</div>","</div>	"].join("\n"),w[1]=['<div class="fullscreen-btn">','<a href="#">Full screen</a>',"</div>"].join("\n"),b={is_active:function(){return m.body.hasClass("fullscreen")},mode:function(){return this.is_active()?S($(window).width(),m.initial_slide,m.nav_location.fullscreen):S(m.normal_width,m.initial_slide,m.nav_location.normal)},apply_ui:function(){a(w[0]),$("#ghost-right").append(w[1]),r(".fullscreen-btn","click",function(){b.toggle()})},toggle:function(){m.body.toggleClass("fullscreen"),o.reloadSlider(b.mode()),b.is_active()||C(),h.update(m.initial_slide,!1)}}}var k=function(e,n){if(!m.ui_switch)return!1;{var t=n.constructor===Array?n:[n];$(".feature-wrapper")}$.each(t,function(n,t){return t==e?(c.feature_wrapper.addClass("ui-switch"),!1):c.feature_wrapper.hasClass("ui-switch")?(c.feature_wrapper.removeClass("ui-switch"),!1):void 0})},C=function(){var e=$(".bx-viewport").offset().left+$(".bx-viewport").width();$(".ghost").each(function(){var n=$(this),t=n.attr("id").replace("ghost-",""),i="left"===t?{right:e}:{left:e};n.css(i)})},S=function(e,n,t){return{slideWidth:e,startSlide:n,pager:g.enabled,pagerSelector:g.container,oneToOneTouch:!1,buildPager:function(e){return g.generate_thumbnail(e)},onSliderLoad:function(e){cmCreateElementTag(c.cm_tag+"_"+e,"OUTFIT"),m.initial_slide=e,C(),p.playFrames(e),h.update(e)},onSlideBefore:function(e,n,t){g.toggle_pager(!0),m.initial_slide=t,f.slide(e,y(),n,t),h.update(t,!0),k(t)},onSlideAfter:function(e,n,t){p.playFrames(t,n),cmCreateElementTag(c.cm_tag+"_"+t,"OUTFIT")},prevSelector:t+"left",nextSelector:t+"right"}},T=function(){return C(),b.is_active()?(clearTimeout(l),l=setTimeout(function(){$("."+m.active_class).index()-1;o.reloadSlider(b.mode())},m.resize_delay),!1):void 0},A=function(){return r(window,"resize",function(){T()}),r(".next","click",function(e){e.preventDefault(),o.goToNextSlide()}),m.fullscreen_enabled?void r(m.fullscreen_button,"click",function(){toggle_fullscreen()}):!1},P=function(){try{if("SS15-TEMPLATE"===c.cm_tag)throw"You have not changed the coremetrics tag";if("/images/magazine/features/SS15-carousel/"===c.img_path)throw"You haven't changed the default image path"}catch(e){console.error(e)}},q=function(){$("[name=viewport]","#Head1").attr("content","width=1000"),g.initialise(),p.initialise(),h.initialise(function(){n(),P()}),o=$(".bxslider").bxSlider(b.mode()),b.apply_ui(),n(),A(),v.initialise()};return{init:q}}window.Modernizr=function(e,n,t){function i(e){_.cssText=e}function a(e,n){return typeof e===n}function r(e,n){return!!~(""+e).indexOf(n)}function o(e,n){for(var i in e){var a=e[i];if(!r(a,"-")&&_[a]!==t)return"pfx"==n?a:!0}return!1}function l(e,n,i){for(var r in e){var o=n[e[r]];if(o!==t)return i===!1?e[r]:a(o,"function")?o.bind(i||n):o}return!1}function s(e,n,t){var i=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+b.join(i+" ")+i).split(" ");return a(n,"string")||a(n,"undefined")?o(r,n):(r=(e+" "+y.join(i+" ")+i).split(" "),l(r,n,t))}var c,u,d,f="2.8.3",p={},g=n.documentElement,h="modernizr",v=n.createElement(h),_=v.style,m=({}.toString,"Webkit Moz O ms"),b=m.split(" "),y=m.toLowerCase().split(" "),x={},$=[],w=$.slice,k={}.hasOwnProperty;d=a(k,"undefined")||a(k.call,"undefined")?function(e,n){return n in e&&a(e.constructor.prototype[n],"undefined")}:function(e,n){return k.call(e,n)},Function.prototype.bind||(Function.prototype.bind=function(e){var n=this;if("function"!=typeof n)throw new TypeError;var t=w.call(arguments,1),i=function(){if(this instanceof i){var a=function(){};a.prototype=n.prototype;var r=new a,o=n.apply(r,t.concat(w.call(arguments)));return Object(o)===o?o:r}return n.apply(e,t.concat(w.call(arguments)))};return i}),x.backgroundsize=function(){return s("backgroundSize")},x.csstransforms=function(){return!!s("transform")},x.csstransitions=function(){return s("transition")};for(var C in x)d(x,C)&&(u=C.toLowerCase(),p[u]=x[C](),$.push((p[u]?"":"no-")+u));return p.addTest=function(e,n){if("object"==typeof e)for(var i in e)d(e,i)&&p.addTest(i,e[i]);else{if(e=e.toLowerCase(),p[e]!==t)return p;n="function"==typeof n?n():n,"undefined"!=typeof enableClasses&&enableClasses&&(g.className+=" "+(n?"":"no-")+e),p[e]=n}return p},i(""),v=c=null,p._version=f,p._domPrefixes=y,p._cssomPrefixes=b,p.testProp=function(e){return o([e])},p.testAllProps=s,p}(this,this.document);